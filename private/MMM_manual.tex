 \documentclass[a4paper, 11pt]{article}

% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage[ansinew]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{setspace}
\usepackage{guje}

\begin{document}
\onehalfspacing

% Formatierung fur Marginalien bei Schriftgroe 11pt---
\setlength{\parindent}{0pt}
\setlength{\oddsidemargin}{0.5cm}
\setlength{\evensidemargin}{3.3cm}
\setlength{\topmargin}{-0.5cm}
\addtolength{\textheight}{0.5cm}
\addtolength{\textwidth}{-3.5cm}
\setlength{\marginparwidth}{3cm}

\title{MMM- Multiscale modeling of macromolecular systems}

\author{G. Jeschke \\ ETH Zürich, Lab. Phys. Chem. \\ \\ Gunnar.Jeschke@phys.chem.ethz.ch \\}

\maketitle 

\tableofcontents

\newpage

% main text
\section{Introduction}
\label{introduction}

\subsection{Why yet another program for protein modeling?}
\label{why}
There are many good and even free software packages for visualization of biomacromolecules and biomacromolecule complexes. Some of them are open source and could be extended to use information from newly developed techniques, such as distance measurements by pulsed electron paramagnetic resonance (EPR) spectroscopy \cite{Jeschke:07,Schiemann:07}. However, our experience with rotamer libraries for the description of spin label conformations has shown that rather complex extensions may be required that would be difficult and inefficient to introduce into software packages designed for work with atomistically resolved x-ray and NMR structures. Our previous workaround were home-written programs for modeling that can read and write PDB files \footnote{For definition of the PDB format, see http://www.wwpdb.org/docs.html}. This approach has now run into the following problems:

\begin{itemize}
	\item The PDB format is designed for static atomistic coordinates, as obtained by x-ray or NMR techniques. In many cases experimental information is available that is insufficient to build an atomistic model, but is still useful.
	\item The PDB format- and programs based on it- do not allow for introducing low-resolution objects, such as a lipid bilayer, without specifying atomic coordinates.
	\item The PDB format- and programs based on it- consider structures as generally certain, if possibly incomplete. In fact, different parts of a structural model may be known with different degrees of certainty and with different resolution. 
\end{itemize}

These problems have led to an unsatisfying situation in modeling of biomacromolecular systems. Atomistic structures are generally considered as reliable and as a finished, static model of the system. In reality they are snapshots that describe only part of the behavior of the system. Non-atomistic models are generated by \emph{ad hoc} methods geared to the type and quantity of information accessible at the time of modeling. They often exist only as pictures, not mathematically formalized models, which makes systematic improvement by new experimental information impossible. As an alternative they can be specified in atomistic coordinates, but with the caveat that much of the information content is based on mere assumptions and there is no systematic way to specify what part of the information that is. For this reason non-atomistic models are seen as unreliable- and they often are!

In fact, a protein or, more generally, a complex of biomacromolecules and cofactors is a dynamic system. Information on this system is not obtained by a single group who solves "the structure" and it is \emph{never complete}. In other words, the structure file cannot be closed, as a data base with unchangeable files suggests. A protein model is an evolving object that becomes more and more detailed- and more and more dynamic- over time. Information of several studies from different groups should be incorporated and it should be possible to extend the model by information from newly developed experimental approaches, even if these were unknown when the first version of the model was built. In other words, a protein model is not like a Shakespeare play, once written by a single author and never changed after that, but rather like a software package that has many contributors and goes through many versions.

This view of protein models is at odds with the basic data structure assumed in the PDB format and by established modeling programs. The problem cannot be solved by extension of these programs, as the architecture of a program depends very much on the concept of the processed data. For that reason a complete redesign of the modeling approach is required. This approach should encompass atomistic structures, as these are by far the most reliable models that we currently have. However, it should allow for models that have different resolution and different degrees of certainty in different domains and that can be specified as dynamic with respect to the conformation of certain domains or their relative arrangement.

The basic idea of multiscale coarse-grained modeling, which can form the mathematical basis for such a program, has emerged in the molecular dynamics (MD) community as a way to overcome severe limitations in the time scale of simulations of protein dynamics and folding \cite{Doruker:02,Bond:06}. However, our approach is concerned with modeling based on \emph{experimental} data, supported by simulations. Hence, our primary concern is not a realistic description of the energy of the system, as it is sought by the MD community. The aim of our approach is to build models that are consistent with a set of experimental restraints from different techniques and with established theoretical knowledge on protein structure. Furthermore, the uncertainty of such models should be specified as far as possible.

As not all the mathematics and not all the experimental techniques or even types of restraints are yet known (or will ever be known) the whole approach in general and the program in particular have to be extensible. This starts with the data format for encoding the model. Object-oriented programming \cite{Meyer:97} appears to be best suited for such a program.    

\subsection{What the program should do and how the user interface should look like}
\label{philosophy}
For many basic tasks in computational structural biology powerful approaches do already exist. Reprogramming everything would be inefficient and would probably not result in a program that matches the performance of the best available software for that task. The program should thus be open not only with respect to future extensions, but also with respect to communication with third-party software. Examples are

\begin{itemize}
	\item Optimization of sidegroup packing, for instance after mutations, by SCWRL3 \cite{Canutescu:03}.
	\item Molecular dynamics, based on the AMBER, CHARMM, or GROMOS force fields, for instance using Tinker\footnote{see: http://dasher.wustl.edu/tinker/} with AMBER96 (Ponder:03).
	\item Use of NMR or x-ray data and work with analogous restraints by interfacing to CNS \cite{Brunger:98}. 
\end{itemize}
  
The program should implement new algorithms for working with experimental techniques that are not yet used for structure determination in a systematic way, foremost EPR. It should also implement modeling for structural transitions (function-related structural dynamics). Furthermore, the program needs to be able to define restraints with respect to coarse-grained objects, for instance the immersion depth of a residue in a lipid bilayer that is defined only by its center plane and thickness.

Although very pleasing visualization programs for proteins exist, our program needs to implement visualization, mainly because systematic coarse-graining is not possible in the existing programs. Here we do not strive for the aesthetically most pleasing visualization, as in many cases it will be possible to visualize a finished version of the model with other software. Rather the visualization approach should allow to find the wanted information in the model with the least effort. It should thus be possible to guide the display by certain questions about the structure or structural transitions, rather than searching the information by trial-and-error rotations with the mouse.

This calls for a user interface that is at the same time precise and easy to work with. As the models are complex- and will be even more complex in the future- the tasks will be complex. The user will soon be annoyed with the need to perform the same 100 mouse clicks again and again. Hence, the program needs a scripting language and must be based on a command interpreter. Experience shows that most users (initially) do not like command control of programs. Hence, the whole functionality of the program should be accessible by mouse clicks. This apparent contradiction can be solved by assigning commands to each menu function, tool button and push button and by echoing the commands initiated with the mouse in the command line. Thus users can learn the command language conveniently and at their own pace.

Complex tasks call for an 'undo' function. In fact, it should be possible to undo several actions and redo them if necessary. This is easy to implement in a command-based approach by defining an inverse command for each command and storing it in an undo list. At the same time the command history is stored. Undone commands are stored in a redo list. Some tasks, in particular if they involve external programs, may not be undoable or only at considerable expense in computation time, storage, and programming effort. In such cases the user should be warned that the command cannot be taken back after execution. The user should be given the possibility to veto command execution.

Although windows of most current graphical user interfaces (GUIs) can be resized, this actually does not make sense. In a good GUI everything is at the same place every time, as most people have some degree of visual memory and can navigate more easily when it looks the same. On the other hand, the window that displays the model should be resizeable. This is necessary as one may want to work on computers with different screen resolution and one wants to see as much detail as possible with given screen resolution. Hence, the model display window should be detachable from the GUI, so that it can be resized indepedently. It should also be reattachable, as some actions require only a small picture of the structure and are easier to perform with this picture in the GUI.

Written information is nowadays underestimated. Some results are best displayed as words and numbers. The GUI should contain a large message board to display such information routinely in the same place, where users really look for it, rather than in a hidden tab that the uesers first have to find. Special tasks may require special forms of display that are not suited for the model display window or the message board. In this case additional windows should be opened. 

\section{Hierachical description of macromolecular models}  
\label{hierarchy}
cite CNS

\section{Display algorithms}
\label{display}

\subsection{Ribbon models}
\label{ribbon}
Coarse-grained graphical representations were utilized in an early comprehensive review on structural features of proteins \cite{Richardson:81} and shortly thereafter computer-generated schematic diagrams were proposed \cite{Lesk:82}. Here we start from the formal description of the ribbon model \cite{Carson:86}, which uses six parameters per residue $k$, the coordinates of the C${^\alpha}_k$ atom and the carbonyl oxygen atom O$_k$. The local frame $\vec{a}_k, \vec{c}_k, \vec{d}_k$ at each residue is derived starting with a unit vector $\vec{a}_k$ pointing along the backbone from C$^{\alpha}_k$ to C$^{\alpha}_{k+1}$. The auxiliary unit vector $\vec{b}_k$ points from C$^{\alpha}_k$ to the carbonyl oxygen O$_k$. The unit vector $\vec{c}_k$ perpendicular to the approximate peptide plane is generated by the cross product
\begin{equation}
	\vec{c}_k = \vec{a}_k \times \vec{b}_k \ ,
\end{equation}
and the Cartesian frame is completed by unit vector $\vec{d}_k$ within the peptide plane
\begin{equation}
	\vec{d}_k = \vec{c}_k \times \vec{a}_k \ .
\end{equation}
The flat face of the ribbon is the approximate peptide plane, i.e., it contains $\vec{d}_k$. For the last residue C$^{\alpha}_{k+1}$ is not defined, so that we keep $\vec{d}_k$ from the previous residue.
For the typical right-handed $\alpha$-helix vector $\vec{d}_k$ points to the right of the backbone. For $\beta$-sheets the complication arises that $\vec{d}_k$ flips from the right to the left backbone side or \emph{vice versa} between consecutive residues. Hence vector $\vec{d}_k$ has to be inverted each other residue in sheets \cite{Carson:86}.

The original implementation of ribbon models constructs guide points between residues and interpolates between guide points by B-splines, which were convenient as they could be handled by graphics devices at that time \cite{Carson:86}. Here we depart from these conventions. First, we assign the guide points to the C$^{\alpha}_k$, so that the parameters of the residue in the coarse-grained representation are the coordinates of C$^{\alpha}_k$ and unit vector $\vec{f}_k$. This assigns all parameters to the local frame of residue $k$ and reduces the number of free parameters per residue to five. Second, we specify the interpolating splines as cardinal splines with zero tension (Catmull-Rom splines). Past implementations use different interpolation techniques, as can be seen by comparing the representations of loops in different programs, for instance PyMOL \cite{DeLano:02}\footnote{http://www.pymol.org} and Swiss-Pdb Viewer \cite{Guex:97}. Our implementation is similar to the one in PyMOL, however, it does not apply additional smoothing to the ribbons. The effect of smoothing is particularly strong for $\beta$-sheets, but can also be seen in $\alpha$-helices.

Helical segments are defined with a rectangular cross-section of the ribbon with width 3 \AA along $\vec{d}_k$ and height 0.2 \AA along $\vec{c}_k$. For sheets we also use a rectangular cross-section of the ribbon with width 2 \AA and height 0.2 \AA along $\vec{c}_k$. The last residue is marked by an arrow that starts at 1.75 times the original width and narrows to zero at the end of the sheet. Loops and turns are defined by a circular cross section with radius 0.2 \AA, which is approximated by a decagon. By spline interpolation we define five straight segments per residue, which provides a satisfying compromise between aesthetic quality and speed of Matlab graphics. 

\begin{thebibliography}{99}
\bibitem{Jeschke:07}
G. Jeschke, Ye. Polyhach, {\it Phys. Chem. Chem. Phys.}, 2007, {\bf 9}, 1895--1910.
\bibitem{Schiemann:07}
O. Schiemann, T. F. Prisner, {\it Quater. Rev. Biophys.}, 2007, {\bf 40}, 1--53.
\bibitem{Doruker:02}
P. Doruker, R. L. Jernigan, I. Bahar, {\it J. Comp. Chem.}, 2002, {\bf 23}, 119--127.
\bibitem{Bond:06}
P. J. Bond, M. S. P. Sansom, {\it J. Am. Chem. Soc.}, 2006, {\bf 128}, 2697--2704.
\bibitem{Meyer:97}
B. Meyer, {\it Object-oriented Software Construction}, Prentice Hall, New York, 1997.
\bibitem{Canutescu:03}
A. A. Canutescu, A. A. Shelenkov, R. L. Jr. Dunbrack, 2003, {\it Protein Science}, {\bf 12}, 2001--2014.
\bibitem{Ponder:03}
J.W. Ponder, D.A. Case, 2003, {\it Adv. Prot. Chem.}, {\bf 66}, 27--85.
\bibitem{Brunger:98}
A. T. Brunger, P. D. Adams, G. M. Clore, P. Gros, R. W. Grosse-Kunstleve, J.-S. Jiang, J. Kuszewski, N. Nilges, N.S. Pannu, R.J. Read, L.M. Rice, T. Simonson, G.L. Warren, 1998, {\it Acta Cryst.D}. {\bf 54}, 905--921.
\bibitem{Richardson:81}
J.S. Richardson, 1981, {\it Adv. Protein Chem.}, {\bf 34}, 167--339. 
\bibitem{Lesk:82}
A. M. Lesk, K. D. Hardman, 1982, {\it Science}, {\bf 216}, 539--540.
\bibitem{Carson:86}
M. Carson, C. E. Bugg, 1986, {\it J. Mol. Struct.}, {\bf 4}, 121-122.
\bibitem{DeLano:02}
W. L. DeLano, 2002, {\it The PyMOL Molecular Graphics System} DeLano Scientific, San Carlos, CA, USA.
\bibitem{Guex:97}
N. Guex, M. C. Peitsch, 1997, {\it Electrophoresis}, {\bf 18}, 2714--2723. 
\bibitem{Jeschke:02b}
G. Jeschke, A. Koch, U. Jonas, A. Godt, {\it J. Magn. Reson.}, 2002, {\bf 155}, 72--82.
\bibitem{Jeschke:04}
G. Jeschke, G. Panek, A. Godt, A. Bender, H. Paulsen, {\it Appl. Magn. Reson.}, 2004, {\bf 26}, 223--244.
\bibitem{Chiang:05}
Y. W. Chiang, P. P. Borbat, J. H. Freed, {\it J. Magn. Reson.}, 2005, {\bf 172}, 279--295.
\bibitem{Jeschke:06}
G. Jeschke, V. Chechik, P. Ionita, A. Godt, H. Zimmermann, J. Banham, C. R. Timmel, D. Hilger, H. Jung, {\it Appl. Magn. Reson.}, 2006, {\bf 30}, 473--498.
 
% BibTeX users can use a style-file for PCCP, which can be found on the CTAN internet site of LaTeX: http://www.tex.ac.uk/tex-archive/biblio/bibtex/contrib/chem-journal/pccp.bst
\end{thebibliography}

\end{document}

